{"ast":null,"code":"var _jsxFileName = \"D:\\\\University\\\\8Eighth Semester\\\\BLN\\\\Project\\\\now-ui-kit-react-master\\\\src\\\\views\\\\App.js\";\nimport { Button, Card, CardHeader, CardBody, CardFooter, CardTitle, Form, Input, Table, InputGroupAddon, InputGroupText, InputGroup, Container, Row, Progress } from \"reactstrap\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom'; //import logo from './logo.svg';\n\nimport Web3 from 'web3';\nimport ipfs from './ipfs';\nimport storehash from './storehash'; //header\n//Setting Web3\n\nconst web3 = new Web3(window.web3.currentProvider);\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updateProgress = e => {\n      if (this.state.percent >= 100) {\n        e.preventDefault();\n      }\n\n      this.setState({\n        percent: this.state.percent + 10\n      });\n    };\n\n    this.state = {\n      ipfsHash: null,\n      buffer: '',\n      ethAddress: '',\n      blockNumber: '',\n      transactionHash: '',\n      gasUsed: '',\n      txReceipt: ''\n    };\n\n    this.captureFile = event => {\n      event.stopPropagation();\n      event.preventDefault();\n      const file = event.target.files[0];\n      let value = event.target.value,\n          message;\n      message = value.split('\\\\').pop();\n      if (message) this.setState({ ...this.state,\n        message\n      });\n      let reader = new window.FileReader();\n\n      reader.onloadend = () => this.convertToBuffer(reader);\n\n      reader.readAsArrayBuffer(file);\n    };\n\n    this.convertToBuffer = async reader => {\n      //file is converted to a buffer to prepare for uploading to IPFS\n      const buffer = await Buffer.from(reader.result); //set this buffer -using es6 syntax\n\n      this.setState({\n        buffer\n      });\n    };\n\n    this.onClick = async () => {\n      try {\n        this.setState({\n          blockNumber: \"waiting..\"\n        });\n        this.setState({\n          gasUsed: \"waiting...\"\n        }); // get Transaction Receipt in console on click\n        // See: https://web3js.readthedocs.io/en/1.0/web3-eth.html#gettransactionreceipt\n\n        await web3.eth.getTransactionReceipt(this.state.transactionHash, (err, txReceipt) => {\n          console.log(err, txReceipt);\n          this.setState({\n            txReceipt\n          });\n        }); //await for getTransactionReceipt\n\n        await this.setState({\n          blockNumber: this.state.txReceipt.blockNumber\n        });\n        await this.setState({\n          gasUsed: this.state.txReceipt.gasUsed\n        });\n      } //try\n      catch (error) {\n        console.log(error);\n      } //catch\n\n    };\n\n    this.onSubmit = async event => {\n      event.preventDefault();\n\n      if (window.ethereum) {\n        window.web3 = new Web3(window.ethereum);\n\n        try {\n          // Request account access if needed\n          await window.ethereum.enable(); // Acccounts now exposed\n          //bring in user's metamask account address\n\n          const accounts = await web3.eth.getAccounts();\n          console.log('Sending from Metamask account: ' + accounts[0]); //obtain contract address from storehash.js\n\n          const ethAddress = await storehash.options.address;\n          this.setState({\n            ethAddress\n          }); //save document to IPFS,return its hash#, and set hash# to state\n          //https://github.com/ipfs/interface-ipfs-core/blob/master/SPEC/FILES.md#add \n\n          await ipfs.add(this.state.buffer, (err, ipfsHash) => {\n            console.log(err, ipfsHash); //setState by setting ipfsHash to ipfsHash[0].hash \n\n            this.setState({\n              ipfsHash: ipfsHash[0].hash\n            }); // call Ethereum contract method \"sendHash\" and .send IPFS hash to etheruem contract \n            //return the transaction hash from the ethereum contract\n            //see, this https://web3js.readthedocs.io/en/1.0/web3-eth-contract.html#methods-mymethod-send\n\n            storehash.methods.sendHash(this.state.ipfsHash * 10000000000).send({\n              from: accounts[0]\n            }, (error, transactionHash) => {\n              console.log(transactionHash);\n              this.setState({\n                transactionHash\n              });\n            }); //storehash \n          }); //await ipfs.add \n        } catch (error) {\n          alert(\"Permission to Access MetaMask Denied\");\n        }\n      } // Legacy dapp browsers...\n      else if (window.web3) {\n          window.web3 = new Web3(web3.currentProvider); // Acccounts always exposed\n\n          web3.eth.sendTransaction({\n            /* ... */\n          });\n        } // Non-dapp browsers...\n        else {\n            console.log('Non-Ethereum browser detected. You should consider trying MetaMask!');\n          }\n    };\n\n    this.state = {\n      message: 'Choose File...',\n      percent: 10\n    };\n  }\n\n  //onSubmit \n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Container, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      className: \"card-signup\",\n      \"data-background-color\": \"blue\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Form, {\n      action: \"\",\n      className: \"form form-group\",\n      onSubmit: this.onSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(CardHeader, {\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(CardTitle, {\n      className: \"title-up\",\n      tag: \"h3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 19\n      }\n    }, \"Upload\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"social-line\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"btn-neutral btn-icon btn-round\",\n      color: \"github\",\n      onClick: e => e.preventDefault(),\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"now-ui-icons arrows-1_cloud-upload-94\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 23\n      }\n    })))), /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(InputGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(InputGroupText, {\n      \"text-align\": \"center\",\n      style: {\n        \"width\": \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 21\n      }\n    }, this.state.message), /*#__PURE__*/React.createElement(Input, {\n      type: \"file\",\n      className: \"form-control\",\n      onChange: this.captureFile,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(CardFooter, {\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"btn-neutral btn-round\",\n      color: \"info\",\n      type: \"submit\",\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 19\n      }\n    }, \"Submit\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"progress-container progress-neutral\",\n      style: {\n        margin: '1%',\n        'margin-top': '20px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"progress-badge\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 15\n      }\n    }, \"Uploading\"), /*#__PURE__*/React.createElement(Progress, {\n      animated: true,\n      max: \"100\",\n      value: this.state.percent,\n      onClick: () => this.updateProgress(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"progress-value\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 19\n      }\n    }, this.state.percent, \"%\"))))))), /*#__PURE__*/React.createElement(\"hr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Button, {\n      onClick: this.onClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 13\n      }\n    }, \" Get Transaction Receipt \"), /*#__PURE__*/React.createElement(Table, {\n      bordered: true,\n      responsive: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 21\n      }\n    }, \"Tx Receipt Category\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 21\n      }\n    }, \"Values\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 21\n      }\n    }, \"IPFS Hash # stored on Eth Contract\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 21\n      }\n    }, this.state.ipfsHash)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 21\n      }\n    }, \"Ethereum Contract Address\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 21\n      }\n    }, this.state.ethAddress)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 21\n      }\n    }, \"Tx Hash # \"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 21\n      }\n    }, this.state.transactionHash)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 21\n      }\n    }, \"Block Number # \"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 21\n      }\n    }, this.state.blockNumber)), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 21\n      }\n    }, \"Gas Used\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 21\n      }\n    }, this.state.gasUsed))))));\n  } //render\n\n\n}\n\nexport default App;","map":{"version":3,"sources":["D:/University/8Eighth Semester/BLN/Project/now-ui-kit-react-master/src/views/App.js"],"names":["Button","Card","CardHeader","CardBody","CardFooter","CardTitle","Form","Input","Table","InputGroupAddon","InputGroupText","InputGroup","Container","Row","Progress","React","Component","Link","Web3","ipfs","storehash","web3","window","currentProvider","App","constructor","props","updateProgress","e","state","percent","preventDefault","setState","ipfsHash","buffer","ethAddress","blockNumber","transactionHash","gasUsed","txReceipt","captureFile","event","stopPropagation","file","target","files","value","message","split","pop","reader","FileReader","onloadend","convertToBuffer","readAsArrayBuffer","Buffer","from","result","onClick","eth","getTransactionReceipt","err","console","log","error","onSubmit","ethereum","enable","accounts","getAccounts","options","address","add","hash","methods","sendHash","send","alert","sendTransaction","render","margin"],"mappings":"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","sourcesContent":["\nimport {\n  Button,\n  Card,\n  CardHeader,\n  CardBody,\n  CardFooter,\n  CardTitle,\n  Form,\n  Input,\n  Table,\n  InputGroupAddon,\n  InputGroupText,\n  InputGroup,\n  Container,\n  Row,\n  Progress\n} from \"reactstrap\";\nimport React, { Component } from 'react';\nimport {Link} from 'react-router-dom';\n//import logo from './logo.svg';\nimport Web3 from 'web3';\nimport ipfs from './ipfs';\nimport storehash from './storehash';\n//header\n//Setting Web3\nconst web3 = new Web3(window.web3.currentProvider);\nclass App extends Component {\n  \n  constructor(props)\n  {\n    super(props);\n    this.state = {message:'Choose File...',\n                  percent: 10};\n  }\n  updateProgress = (e) => {\n    if(this.state.percent >= 100)\n    {e.preventDefault()}\n    this.setState({ percent: this.state.percent+10});\n  };\n\n    state = {\n      ipfsHash:null,\n      buffer:'',\n      ethAddress:'',\n      blockNumber:'',\n      transactionHash:'',\n      gasUsed:'',\n      txReceipt: ''   \n    };\n   \n    captureFile =(event) => {\n        event.stopPropagation()\n        event.preventDefault()\n        const file = event.target.files[0]\n        let  value = event.target.value,\n        message;\n        message = value.split( '\\\\' ).pop();\n        if(message) this.setState({...this.state,message});\n        let reader = new window.FileReader()\n        reader.onloadend = () => this.convertToBuffer(reader)    \n        reader.readAsArrayBuffer(file)\n      };\n\n    convertToBuffer = async(reader) => {\n      //file is converted to a buffer to prepare for uploading to IPFS\n        const buffer = await Buffer.from(reader.result);\n      //set this buffer -using es6 syntax\n        this.setState({buffer});\n    };\n\n    onClick = async () => {\n\n    try{\n        this.setState({blockNumber:\"waiting..\"});\n        this.setState({gasUsed:\"waiting...\"});\n\n        // get Transaction Receipt in console on click\n        // See: https://web3js.readthedocs.io/en/1.0/web3-eth.html#gettransactionreceipt\n        await web3.eth.getTransactionReceipt(this.state.transactionHash, (err, txReceipt)=>{\n          console.log(err,txReceipt);\n          this.setState({txReceipt});\n        }); //await for getTransactionReceipt\n\n        await this.setState({blockNumber: this.state.txReceipt.blockNumber});\n        await this.setState({gasUsed: this.state.txReceipt.gasUsed});    \n      } //try\n    catch(error){\n        console.log(error);\n      } //catch\n  } //onClick\n\n    onSubmit = async (event) => {\n      event.preventDefault();\n      if (window.ethereum) {\n        window.web3 = new Web3(window.ethereum);\n        try {\n            // Request account access if needed\n            await window.ethereum.enable();\n            // Acccounts now exposed\n            \n                 //bring in user's metamask account address\n                const accounts = await web3.eth.getAccounts();\n              \n                console.log('Sending from Metamask account: ' + accounts[0]);\n\n                //obtain contract address from storehash.js\n                const ethAddress= await storehash.options.address;\n                this.setState({ethAddress});\n\n                //save document to IPFS,return its hash#, and set hash# to state\n                //https://github.com/ipfs/interface-ipfs-core/blob/master/SPEC/FILES.md#add \n                await ipfs.add(this.state.buffer, (err, ipfsHash) => {\n                  console.log(err,ipfsHash);\n                  //setState by setting ipfsHash to ipfsHash[0].hash \n                  this.setState({ ipfsHash:ipfsHash[0].hash });\n\n                  // call Ethereum contract method \"sendHash\" and .send IPFS hash to etheruem contract \n                  //return the transaction hash from the ethereum contract\n                  //see, this https://web3js.readthedocs.io/en/1.0/web3-eth-contract.html#methods-mymethod-send\n                  \n                  storehash.methods.sendHash(this.state.ipfsHash*10000000000).send({\n                    from: accounts[0] \n                  }, (error, transactionHash) => {\n                    console.log(transactionHash);\n                    this.setState({transactionHash});\n                  }); //storehash \n                }) //await ipfs.add \n\n\n        } catch (error) {\n            alert(\"Permission to Access MetaMask Denied\");\n        }\n    }\n    // Legacy dapp browsers...\n    else if (window.web3) {\n        window.web3 = new Web3(web3.currentProvider);\n        // Acccounts always exposed\n        web3.eth.sendTransaction({/* ... */});\n    }\n    // Non-dapp browsers...\n    else {\n        console.log('Non-Ethereum browser detected. You should consider trying MetaMask!');\n    }\n\n      \n    }; //onSubmit \n  \n    render() {\n      \n      return (\n        <div>\n        <Container>\n          <Row>\n            <Card className=\"card-signup\" data-background-color=\"blue\">\n              <Form action=\"\" className=\"form form-group\" onSubmit={this.onSubmit}>\n                <CardHeader className=\"text-center\">\n                  <CardTitle className=\"title-up\" tag=\"h3\">\n                    Upload\n                  </CardTitle>\n                  <div className=\"social-line\">\n                    <Button\n                      className=\"btn-neutral btn-icon btn-round\"\n                      color=\"github\"\n                      onClick={e => e.preventDefault()}\n                      size=\"lg\"\n                    >\n                      <i className=\"now-ui-icons arrows-1_cloud-upload-94\"></i>\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardBody>\n                  <InputGroup>\n                    <InputGroupText text-align=\"center\" style={{\"width\" : \"100%\"}}>\n                    {this.state.message}\n                      </InputGroupText>\n                    <Input\n                      type=\"file\"\n                      className=\"form-control\"\n                      onChange = {this.captureFile}\n                    ></Input>\n                  </InputGroup>\n                </CardBody>\n                <CardFooter className=\"text-center\">\n                  <Button\n                    className=\"btn-neutral btn-round\"\n                    color=\"info\"\n                    type=\"submit\"\n                    size=\"lg\"\n                  >\n                    Submit\n                  </Button>\n              \n              <div className=\"progress-container progress-neutral\" style={{margin:'1%','margin-top':'20px'}}>\n              <span className=\"progress-badge\">Uploading</span>\n                <Progress animated max=\"100\" value={this.state.percent} onClick={() => this.updateProgress()} >\n                  <span className=\"progress-value\">{this.state.percent}%</span>\n                </Progress>\n              </div>\n                </CardFooter>\n              </Form>\n\n            </Card>\n          </Row>\n          <hr/>\n            <Button onClick = {this.onClick}> Get Transaction Receipt </Button>\n              <Table bordered responsive>\n                <thead>\n                  <tr>\n                    <th>Tx Receipt Category</th>\n                    <th>Values</th>\n                  </tr>\n                </thead>\n               \n                <tbody>\n                  <tr>\n                    <td>IPFS Hash # stored on Eth Contract</td>\n                    <td>{this.state.ipfsHash}</td>\n                  </tr>\n                  <tr>\n                    <td>Ethereum Contract Address</td>\n                    <td>{this.state.ethAddress}</td>\n                  </tr>\n\n                  <tr>\n                    <td>Tx Hash # </td>\n                    <td>{this.state.transactionHash}</td>\n                  </tr>\n\n                  <tr>\n                    <td>Block Number # </td>\n                    <td>{this.state.blockNumber}</td>\n                  </tr>\n\n                  <tr>\n                    <td>Gas Used</td>\n                    <td>{this.state.gasUsed}</td>\n                  </tr>                \n                </tbody>\n            </Table>\n        </Container>\n    </div>\n      );\n    } //render\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}